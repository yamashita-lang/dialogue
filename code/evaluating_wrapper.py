from dialogue.config import LAYERS, CONTEXT_LENGTH
from dialogue.modeling.stat_utils import score_tests_intramodal, score_tests_cross_modal, varpart, best_uniqvarpart_rgb
import argparse
parser=argparse.ArgumentParser(description='Run himalaya for each subject')
parser.add_argument('subject_idx', type=int, help='subject_idx (e.g., 1 for sub-OSU01)')
args=parser.parse_args()
subj_id=args.subject_idx-1


##########################################################################################################################################################################
##########################################################################################################################################################################
### Head Motion model
##########################################################################################################################################################################
##########################################################################################################################################################################
score_tests_intramodal(subj_id, 'headmotion', 'headmotion')


##########################################################################################################################################################################
##########################################################################################################################################################################
### Random embedding model
##########################################################################################################################################################################
##########################################################################################################################################################################
score_tests_intramodal(subj_id, 'gpt_nprandom', 'headmotion', layer=0)


##########################################################################################################################################################################
##########################################################################################################################################################################
### Separate and Unified Linguistic model
##########################################################################################################################################################################
##########################################################################################################################################################################
model_prefix = 'chatgpt'
for cl in CONTEXT_LENGTH:
    for layer in LAYERS:
        model=f"{model_prefix}_{cl}"
        score_tests_intramodal(subj_id, model, 'gpt_nprandom', layer=layer, cl=cl)
        score_tests_cross_idmodal(subj_id, model, 'gpt_nprandom', layer=layer, cl=cl)

model_prefix = 'chatgpt_unified'
for cl in CONTEXT_LENGTH:
    for layer in LAYERS:
        model=f"{model_prefix}_{cl}"
        score_tests_intramodal(subj_id, model, 'gpt_nprandom', layer=layer, cl=cl)


##########################################################################################################################################################################
##########################################################################################################################################################################
### Variance partitioning
##########################################################################################################################################################################
##########################################################################################################################################################################
model_prefix = 'chatgpt'
for cl in CONTEXT_LENGTH:
    for layer in LAYERS:
        varpart(subj_id, 'gpt_nprandom', model_prefix=model_prefix, layer=layer, cl=cl)
        best_uniqvarpart_rgb(subj_id, 'gpt_nprandom', model_prefix=model_prefix, layer=layer, cl=cl)



